<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EA FC 25 Stats</title>
  <link href="https://fonts.googleapis.com/css2?family=Carme&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color-light: #f9f9f9;
      --text-color-light: #333;
      --bg-color-dark: #333;
      --text-color-dark: #f9f9f9;
      --card-bg-light: #fff;
      --card-bg-dark: #444;
      --border-color-light: #ddd;
      --border-color-dark: #555;
    }

    body {
      font-family: 'Carme', sans-serif;
      background-color: var(--bg-color-light);
      color: var(--text-color-light);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
    }

    h1 {
      font-weight: 400;
      text-align: center;
      margin: 20px 0;
    }

    label, select, input, button {
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 10px;
    }

    button {
      font-weight: bold;
      padding: 10px 20px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
    }

    button:hover {
      background-color: #45a049;
    }

    .danger {
      background-color: #f44336;
    }

    .danger:hover {
      background-color: #e53935;
    }

    .dark-mode {
      background-color: var(--bg-color-dark);
      color: var(--text-color-dark);
    }

    table {
      width: 100%;
      max-width: 1200px;
      border-collapse: collapse;
      margin-top: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    th, td {
      border: 1px solid var(--border-color-light);
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #f4f4f4;
      font-weight: bold;
    }

    .dark-mode th {
      background-color: #555;
    }

    .dark-mode td {
      border-color: var(--border-color-dark);
    }

    #penalty-score {
      display: none;
      margin-top: 10px;
    }

    .buttons {
      margin-top: 20px;
    }

    .buttons button {
      margin-right: 10px;
    }

    .delete-match {
      background-color: #ff9800;
      color: white;
    }

    .delete-match:hover {
      background-color: #fb8c00;
    }
  </style>
</head>
<body>
  <h1>EA FC 25 Stats</h1>

  <button id="toggle-theme">Toggle Dark Mode</button>

  <form id="match-form">
    <label for="tournament">Choose a Tournament:</label>
    <select id="tournament" required>
      <option value="rivals">Rivals</option>
      <option value="qualification">Qualification Weekend League</option>
      <option value="weekend_league">Weekend League</option>
    </select>

    <label for="score">Enter Score (e.g., 2:1):</label>
    <input type="text" id="score" required placeholder="Enter score (e.g., 2:1)" list="score-suggestions" />
    <datalist id="score-suggestions"></datalist>

    <div id="penalty-score">
      <label for="penalty">Enter Penalty Score (e.g., 3:2):</label>
      <input type="text" id="penalty" placeholder="Enter penalty score (e.g., 3:2)" />
    </div>

    <button type="submit">Submit Match</button>
  </form>

  <div class="buttons">
    <button id="delete-last">Delete Last Match</button>
    <button id="clear-all" class="danger">Clear All Statistics</button>
  </div>

  <div id="stats" class="stats-container"></div>
  <div id="overall-stats" class="stats-container"></div>
  <div id="match-results" class="results-table"></div>

  <script>
    const stats = {
      rivals: { wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, games: 0 },
      qualification: { wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, games: 0 },
      weekend_league: { wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, games: 0 },
    };

    const matchHistory = [];

    const form = document.getElementById('match-form');
    const statsDiv = document.getElementById('stats');
    const overallStatsDiv = document.getElementById('overall-stats');
    const resultsTableDiv = document.getElementById('match-results');
    const penaltyInput = document.getElementById('penalty-score');
    const scoreInput = document.getElementById('score');
    const penaltyField = document.getElementById('penalty');
    const tournamentInput = document.getElementById('tournament');
    const toggleThemeBtn = document.getElementById('toggle-theme');

    function saveStats() {
      localStorage.setItem('stats', JSON.stringify(stats));
      localStorage.setItem('matchHistory', JSON.stringify(matchHistory));
    }

    function loadStats() {
      const savedStats = JSON.parse(localStorage.getItem('stats'));
      const savedHistory = JSON.parse(localStorage.getItem('matchHistory'));

      if (savedStats) {
        Object.assign(stats, savedStats);
      }

      if (savedHistory) {
        matchHistory.push(...savedHistory);
      }
    }

    function saveTheme(isDark) {
      localStorage.setItem('darkMode', isDark);
    }

    function loadTheme() {
      const isDark = JSON.parse(localStorage.getItem('darkMode'));
      if (isDark) {
        document.body.classList.add('dark-mode');
      }
    }

    function updateStatsTable() {
      statsDiv.innerHTML = '<table>' +
        '<thead>' +
          '<tr><th>Tournament</th><th>Games</th><th>Wins</th><th>Losses</th><th>Draws</th><th>Goals Scored</th><th>Goals Conceded</th></tr>' +
        '</thead>' +
        '<tbody>' +
          Object.keys(stats).map(tournament => {
            const { games, wins, losses, draws, goalsScored, goalsConceded } = stats[tournament];
            return `<tr><td>${tournament}</td><td>${games}</td><td>${wins}</td><td>${losses}</td><td>${draws}</td><td>${goalsScored}</td><td>${goalsConceded}</td></tr>`;
          }).join('') +
        '</tbody>' +
      '</table>';
    }

    function updateOverallStats() {
      const totalGames = Object.values(stats).reduce((sum, { games }) => sum + games, 0);
      const totalWins = Object.values(stats).reduce((sum, { wins }) => sum + wins, 0);
      const totalLosses = Object.values(stats).reduce((sum, { losses }) => sum + losses, 0);
      const totalDraws = Object.values(stats).reduce((sum, { draws }) => sum + draws, 0);
      const totalGoalsScored = Object.values(stats).reduce((sum, { goalsScored }) => sum + goalsScored, 0);
      const totalGoalsConceded = Object.values(stats).reduce((sum, { goalsConceded }) => sum + goalsConceded, 0);

      overallStatsDiv.innerHTML = '<table>' +
        '<thead>' +
          '<tr><th>Total Games</th><th>Total Wins</th><th>Total Losses</th><th>Total Draws</th><th>Total Goals Scored</th><th>Total Goals Conceded</th></tr>' +
        '</thead>' +
        '<tbody>' +
          `<tr><td>${totalGames}</td><td>${totalWins}</td><td>${totalLosses}</td><td>${totalDraws}</td><td>${totalGoalsScored}</td><td>${totalGoalsConceded}</td></tr>` +
        '</tbody>' +
      '</table>';
    }

    function updateResultsTable() {
      if (!matchHistory.length) {
        resultsTableDiv.innerHTML = '<p>No matches recorded yet.</p>';
        return;
      }

      resultsTableDiv.innerHTML = '<table>' +
        '<thead>' +
          '<tr><th>Timestamp</th><th>Tournament</th><th>Score</th><th>Penalty</th><th>Actions</th></tr>' +
        '</thead>' +
        '<tbody>' +
          matchHistory.map((match, index) => {
            const { tournament, score, penalty, timestamp } = match;
            return `<tr>
              <td>${new Date(timestamp).toLocaleString()}</td>
              <td>${tournament}</td>
              <td>${score}</td>
              <td>${penalty || 'N/A'}</td>
              <td><button class="delete-match" data-index="${index}">Delete</button></td>
            </tr>`;
          }).join('') +
        '</tbody>' +
      '</table>';

      document.querySelectorAll('.delete-match').forEach(button => {
        button.addEventListener('click', (e) => {
          const index = e.target.dataset.index;
          const removedMatch = matchHistory.splice(index, 1)[0];
          const { tournament, score } = removedMatch;
          const [goalsScored, goalsConceded] = score.split(':').map(Number);

          stats[tournament].games--;
          stats[tournament].goalsScored -= goalsScored;
          stats[tournament].goalsConceded -= goalsConceded;

          if (goalsScored === goalsConceded) {
            stats[tournament].draws--;
          } else if (goalsScored > goalsConceded) {
            stats[tournament].wins--;
          } else {
            stats[tournament].losses--;
          }

          saveStats();
          updateStatsTable();
          updateOverallStats();
          updateResultsTable();
        });
      });
    }

    toggleThemeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      saveTheme(document.body.classList.contains('dark-mode'));
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const tournament = tournamentInput.value;
      const score = scoreInput.value.trim();
      const penalty = penaltyField.value.trim();
      const [goalsScored, goalsConceded] = score.split(':').map(Number);
      const isDraw = goalsScored === goalsConceded;
      const isWin = goalsScored > goalsConceded;

      stats[tournament].games++;
      stats[tournament].goalsScored += goalsScored;
      stats[tournament].goalsConceded += goalsConceded;

      if (isDraw) {
        stats[tournament].draws++;
      } else if (isWin) {
        stats[tournament].wins++;
      } else {
        stats[tournament].losses++;
      }

      matchHistory.push({ tournament, score, penalty: penalty || null, timestamp: new Date() });

      saveStats();
      updateStatsTable();
      updateOverallStats();
      updateResultsTable();
      scoreInput.value = '';
      penaltyField.value = '';
    });

    tournamentInput.addEventListener('change', () => {
      if (['qualification', 'weekend_league'].includes(tournamentInput.value)) {
        penaltyInput.style.display = 'block';
      } else {
        penaltyInput.style.display = 'none';
      }
    });

    document.getElementById('delete-last').addEventListener('click', () => {
      if (!matchHistory.length) return;

      const lastMatch = matchHistory.pop();
      const { tournament, score } = lastMatch;
      const [goalsScored, goalsConceded] = score.split(':').map(Number);

      stats[tournament].games--;
      stats[tournament].goalsScored -= goalsScored;
      stats[tournament].goalsConceded -= goalsConceded;

      if (goalsScored === goalsConceded) {
        stats[tournament].draws--;
      } else if (goalsScored > goalsConceded) {
        stats[tournament].wins--;
      } else {
        stats[tournament].losses--;
      }

      saveStats();
      updateStatsTable();
      updateOverallStats();
      updateResultsTable();
    });

    document.getElementById('clear-all').addEventListener('click', () => {
      if (!confirm('Are you sure you want to clear all statistics?')) return;

      Object.keys(stats).forEach(tournament => {
        stats[tournament] = { wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, games: 0 };
      });

      matchHistory.length = 0;
      saveStats();
      updateStatsTable();
      updateOverallStats();
      updateResultsTable();
    });

    loadStats();
    loadTheme();
    updateStatsTable();
    updateOverallStats();
    updateResultsTable();
  </script>
</body>
</html>
